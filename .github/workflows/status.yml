name: å®šæœŸã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
on:
  schedule:
    - cron: '*/5 * * * *'    # 5åˆ†æ¯
  workflow_dispatch:        # æ‰‹å‹•ãƒˆãƒªã‚¬ãƒ¼å¯
jobs:
  update-status:
    runs-on: [self-hosted, windows]
    steps:
      - uses: actions/checkout@v3
      - name: çŠ¶æ…‹ãƒã‚§ãƒƒã‚¯ï¼†JSONå‡ºåŠ›
        shell: powershell
        run: |
          $hosts = @(
            @{ name='PC1'; ip='192.168.1.101'; mac='AA:BB:CC:DD:EE:FF' }
            @{ name='PC2'; ip='192.168.1.102'; mac='11:22:33:44:55:66' }
          )
          $results = foreach ($h in $hosts) {
            $alive = Test-Connection -Count 1 -Quiet -ComputerName $h.ip
            [PSCustomObject]@{ name=$h.name; ip=$h.ip; mac=$h.mac; alive=$alive }
          }
          $results | ConvertTo-Json -Depth 2 | Out-File -Encoding utf8 docs/status.json
      - name: status.json ã‚’ã‚³ãƒŸãƒƒãƒˆ
        uses: stefanzweifel/git-auto-commit-action@v4
        with:
          commit_message: 'ğŸ“¡ update status.json'
          file_pattern: docs/status.json
